<div class="reportes-container">
  <div class="header-section">
    <h1 class="page-title">Reportes</h1>
  </div>

  <div class="table-container">
    <table mat-table [dataSource]="dataSource" matSort class="reportes-table">

      <!-- Icono -->
      <ng-container matColumnDef="icono">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let reporte">
          <img class="reporte-icon" src="assets/img/firma_reporte.svg" alt="icono" />
        </td>
      </ng-container>

      <!-- Nombre -->
      <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</th>
        <td mat-cell *matCellDef="let reporte">{{ reporte.nombre }}</td>
      </ng-container>

      <!-- Resultado -->
      <ng-container matColumnDef="resultado">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Resultado</th>
        <td mat-cell *matCellDef="let reporte">
          <span [ngClass]="getResultadoClass(reporte.resultado)">
            {{ reporte.resultado }}
          </span>
        </td>
      </ng-container>

      <!-- Fecha -->
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha</th>
        <td mat-cell *matCellDef="let reporte">{{ reporte.fecha | date:'dd/MM/yyyy HH:mm' }}</td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Acción</th>
        <td mat-cell *matCellDef="let reporte">
          <div class="acciones-container">
            <button mat-button (click)="verDetalle(reporte)">Ver</button>
            <button mat-icon-button (click)="descargarReporte(reporte)">
              <mat-icon>download</mat-icon>
            </button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[10, 25, 50]" showFirstLastButtons></mat-paginator>

    <div *ngIf="dataSource.data.length === 0" class="no-data">
      <mat-icon>description</mat-icon>
      <p>No hay reportes disponibles</p>
    </div>
  </div>

  <!-- Modal -->
  <div *ngIf="mostrarModal" class="modal-backdrop">
    <div class="modal-content">
      <h2>Detalle del Reporte</h2>
      <p><strong>ID Reporte:</strong> {{ reporteSeleccionado?.id }}</p>
      <p><strong>ID Usuario:</strong> {{ reporteSeleccionado?.idUsuario }}</p>
      <p><strong>ID Documento:</strong> {{ reporteSeleccionado?.idDocumento }}</p>
      <p><strong>Resultado:</strong> {{ reporteSeleccionado?.estadoFirma }}</p>
      <p><strong>Fecha de Generación:</strong> {{ reporteSeleccionado?.fecha | date:'dd/MM/yyyy HH:mm' }}</p>
      <div class="modal-footer">
        <button mat-button (click)="cerrarModal()">Cerrar</button>
      </div>
    </div>
  </div>
</div>
